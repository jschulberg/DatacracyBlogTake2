---
title: 'The Case for D.C. Statehood: An Analytics Approach'
author: Justin S.
date: '2021-07-16'
slug: dc-statehood
categories:
  - R
  - public policy
  - history
tags:
  - EDA
comments: yes
image: ''
menu: ''
share: yes
draft: false
---

51. A prime number. Odd. 

Here are the arguments against D.C. Statehood:
  - Too small
  - Too urban
  - Lacks manufacturing
  - No landfill
  - Political ploy by the Democrats
  - If it were a state it would have the power to control Congress
  - Paying taxes

```{r fig.align='center', fig.height=6, fig.width=6, message=FALSE, warning=FALSE, include=FALSE}
# Set our plot specifications for the rest of the document.
knitr::opts_chunk$set(fig.width = 9,
                      fig.height = 6,
                      fig.align = "center",
                      # Set our code specifications for the rest of the document
                      echo = F,
                      warning = F,
                      message = F)
```

```{r load_libraries}
suppressMessages(library("pacman"))
pacman::p_load(tidyverse, # Data manipulation
               rvest, # Web scraping
               pander, # Data printing
               janitor, # General data cleaning
               stringr, # String manipulation
               "kableExtra", # Used for RMarkdown formatting
               ggplot2 # Visualization package
               )
```

## Taxes
If you ever drive around D.C. and look closely, you'll notice that every license plate is surrounded with the words "NO TAXATION WITHOUT REPRESENTATION". The notion that this country was founded on `r as.integer(format(Sys.Date(), "%Y"))-1776` years ago is one that doesn't hold true in its own capital. 

Below, I scrape tax information from [taxadmin.org](https://www.taxadmin.org/2019-state-tax-revenue) to see how well DC does in paying its taxes compared to other states. Let's start by taking a look at the table

```{r load_tax_info}
# Let's use rvest to load tax data from the table on https://www.taxadmin.org/2019-state-tax-revenue

url <- "https://www.taxadmin.org/2019-state-tax-revenue"

tax_data <- url %>% 
  read_html() %>%
  html_table() 

# 3 tables were pulled, so only use the last one
tax_cleaned <- tax_data[[3]] %>% 
  janitor::clean_names() %>% 
  janitor::remove_empty() %>% 
  # Remove the first row (blanks) and the last 3 rows (blanks and totals)
  slice(2:(n()-3)) %>%
  # Rename first column (named 'x') to state
  rename("state" = "x") %>% 
  mutate(per_capita = as.integer(str_remove_all(per_capita, ","))) 

tax_cleaned %>% 
  # Fix up the headers by replacing the underscores with spaces
  rename_all(funs(str_replace_all(., "_", " "))) %>% 
  # Make everything proper capitalization
  rename_all(funs(str_to_title)) %>% 
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = F,
                font_size = 12) %>%
  # Make the header row bold and black so it's easier to read
  row_spec(0, bold = T, color = "black") %>% 
  scroll_box(height = "400px", width = "100%")
```

Now we'll plot the tax paid per state to see how DC compares.

```{r plot_tax_info}
tax_cleaned %>% 
  # Pull top 10
  top_n(10, per_capita) %>% 
  ggplot(aes(x = reorder(state, per_capita), 
             y = per_capita,
             fill=factor(if_else(state=="Dist. of Columbia", "Highlighted", "Normal"))
             )
         ) +
    scale_fill_manual(name = "State", values=c("slateblue", "light gray")) +
    geom_col() +
    # Add labels
    geom_label(aes(y = per_capita,
                 label = paste("$", per_capita, sep = "")),
             hjust = .75,
             size = 4) +    
  # Change the theme to classic
    theme_classic() +
    coord_flip() + 
    # Let's change the names of the axes and title
    xlab("State") +
    ylab("Taxes paid per capita ($)") +
    labs(title = "Total Taxes Paid by State",
         subtitle = "Taxes are reported on a per-capita basis",
         caption = "Data is gathered from https://www.taxadmin.org/2019-state-tax-revenue") +
    # format our title and subtitle
    theme(plot.title = element_text(hjust = 0, color = "slateblue4"),
          plot.subtitle = element_text(hjust = 0, color = "slateblue2", size = 10),
          plot.caption = element_text(color = "dark gray", size = 10, face = "italic"))

```

## Is Annexation into MD/VA Possible?
It is! There are strong arguments, not least of which is that Alexandria, VA used to be part of the Federal District (and thus could not vote in Federal Elections), but was [annexed by VA](http://www.compromise-of-1850.org/banning-slave-trade-in-washington-dc/) in order to preserve its ability to maintain slavery.

## Conclusion